openapi: 3.0.3
info:
  title: GovIE Messaging API Gateway
  description: Public facing APIs to access MessagingIE features
  version: 0.1.0
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas: {}
paths:
  /health:
    get:
      tags:
        - Health
      description: It checks the current health status of the APIs, pinging all the
        related items
      responses:
        "200":
          description: Default Response
  /api/v1/messages/{messageId}/events:
    get:
      tags:
        - messages
      description: Get complete event history for a message
      parameters:
        - schema:
            type: string
            pattern: ^[0-9][0-9]*|undefined$
            default: "0"
          in: query
          name: offset
          required: false
          description: Indicates where to start fetching data or how many records to skip,
            defining the initial position within the list
        - schema:
            type: string
            default: "20"
            pattern: ^([1-9]|100)|undefined$
          in: query
          name: limit
          required: false
          description: Indicates the maximum number (100) of items that will be returned
            in a single request
        - schema:
            type: string
            format: uuid
          in: path
          name: messageId
          required: true
      responses:
        "200":
          description: Default Response
          content:
            application/json:
              schema:
                type: object
                required:
                  - data
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      required:
                        - id
                        - messageId
                        - subject
                        - receiverFullName
                        - eventType
                        - eventStatus
                        - scheduledAt
                      properties:
                        id:
                          type: string
                          format: uuid
                          description: Unique id of the event
                        messageId:
                          type: string
                          format: uuid
                          description: Unique id of the related message
                        subject:
                          type: string
                          description: Subject of the related message
                        receiverFullName:
                          type: string
                          description: Full name of the recipient
                        eventType:
                          type: string
                          description: Event type description
                        eventStatus:
                          type: string
                          description: Status for event type
                        scheduledAt:
                          type: string
                          description: Date and time which describes when the message has to be sent
                  metadata:
                    type: object
                    properties:
                      links:
                        type: object
                        required:
                          - self
                          - first
                          - last
                          - pages
                        properties:
                          self:
                            type: object
                            properties:
                              href:
                                type: string
                                description: URL pointing to the request itself
                          next:
                            type: object
                            properties:
                              href:
                                type: string
                                description: URL pointing to the next page of results in a paginated response.
                                  If there are no more results, this field may
                                  be omitted
                          prev:
                            type: object
                            properties:
                              href:
                                type: string
                                description: URL pointing to the previous page of results in a paginated
                                  response. If there are no more results, this
                                  field may be omitted
                          first:
                            type: object
                            properties:
                              href:
                                type: string
                                description: URL pointing to the first page of results in a paginated response
                          last:
                            type: object
                            properties:
                              href:
                                type: string
                                description: URL pointing to the first page of results in a paginated response
                          pages:
                            type: object
                            description: It may contain a list of other useful URLs, e.g. one entry for
                              page:'page 1', 'page 2'
                            additionalProperties:
                              type: object
                              properties:
                                href:
                                  type: string
                        description: Object containing the links to the related endpoints
                      totalCount:
                        type: number
                        description: Number representing the total number of available items
        "401":
          description: Default Response
          content:
            application/json:
              schema:
                type: object
                required:
                  - code
                  - detail
                  - requestId
                  - name
                  - statusCode
                properties:
                  code:
                    type: string
                    description: Code used to categorize the error
                  detail:
                    type: string
                    description: Description of the error
                  requestId:
                    type: string
                    description: Unique request id. This one will be used to troubleshoot the
                      problems
                  name:
                    type: string
                    description: Name of the error type
                  validation:
                    type: array
                    items:
                      type: object
                      required:
                        - fieldName
                        - message
                      properties:
                        fieldName:
                          type: string
                        message:
                          type: string
                    description: List of the validation errors
                  validationContext:
                    type: string
                  statusCode:
                    type: number
        "403":
          description: Default Response
          content:
            application/json:
              schema:
                type: object
                required:
                  - code
                  - detail
                  - requestId
                  - name
                  - statusCode
                properties:
                  code:
                    type: string
                    description: Code used to categorize the error
                  detail:
                    type: string
                    description: Description of the error
                  requestId:
                    type: string
                    description: Unique request id. This one will be used to troubleshoot the
                      problems
                  name:
                    type: string
                    description: Name of the error type
                  validation:
                    type: array
                    items:
                      type: object
                      required:
                        - fieldName
                        - message
                      properties:
                        fieldName:
                          type: string
                        message:
                          type: string
                    description: List of the validation errors
                  validationContext:
                    type: string
                  statusCode:
                    type: number
        "404":
          description: Default Response
          content:
            application/json:
              schema:
                type: object
                required:
                  - code
                  - detail
                  - requestId
                  - name
                  - statusCode
                properties:
                  code:
                    type: string
                    description: Code used to categorize the error
                  detail:
                    type: string
                    description: Description of the error
                  requestId:
                    type: string
                    description: Unique request id. This one will be used to troubleshoot the
                      problems
                  name:
                    type: string
                    description: Name of the error type
                  validation:
                    type: array
                    items:
                      type: object
                      required:
                        - fieldName
                        - message
                      properties:
                        fieldName:
                          type: string
                        message:
                          type: string
                    description: List of the validation errors
                  validationContext:
                    type: string
                  statusCode:
                    type: number
        "500":
          description: Default Response
          content:
            application/json:
              schema:
                type: object
                required:
                  - code
                  - detail
                  - requestId
                  - name
                  - statusCode
                properties:
                  code:
                    type: string
                    description: Code used to categorize the error
                  detail:
                    type: string
                    description: Description of the error
                  requestId:
                    type: string
                    description: Unique request id. This one will be used to troubleshoot the
                      problems
                  name:
                    type: string
                    description: Name of the error type
                  validation:
                    type: array
                    items:
                      type: object
                      required:
                        - fieldName
                        - message
                      properties:
                        fieldName:
                          type: string
                        message:
                          type: string
                    description: List of the validation errors
                  validationContext:
                    type: string
                  statusCode:
                    type: number
  /api/v1/messages/events:
    post:
      tags:
        - messages
      description: Query message events with pagination, filters, and HATEOAS links
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                recipientEmail:
                  type: string
                  format: email
                recipientId:
                  type: string
                  format: uuid
                subjectContains:
                  type: string
                dateFrom:
                  type: string
                  format: date-time
                dateTo:
                  type: string
                  format: date-time
                status:
                  enum:
                    - delivered
                    - scheduled
                    - opened
                    - failed
                  description: Filter events by status
      parameters:
        - schema:
            type: string
            pattern: ^[0-9][0-9]*|undefined$
            default: "0"
          in: query
          name: offset
          required: false
          description: Indicates where to start fetching data or how many records to skip,
            defining the initial position within the list
        - schema:
            type: string
            default: "20"
            pattern: ^([1-9]|100)|undefined$
          in: query
          name: limit
          required: false
          description: Indicates the maximum number (100) of items that will be returned
            in a single request
      responses:
        "200":
          description: Default Response
          content:
            application/json:
              schema:
                type: object
                required:
                  - data
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      required:
                        - id
                        - messageId
                        - subject
                        - receiverFullName
                        - eventType
                        - eventStatus
                        - scheduledAt
                      properties:
                        id:
                          type: string
                          format: uuid
                          description: Unique id of the event
                        messageId:
                          type: string
                          format: uuid
                          description: Unique id of the related message
                        subject:
                          type: string
                          description: Subject of the related message
                        receiverFullName:
                          type: string
                          description: Full name of the recipient
                        eventType:
                          type: string
                          description: Event type description
                        eventStatus:
                          type: string
                          description: Status for event type
                        scheduledAt:
                          type: string
                          description: Date and time which describes when the message has to be sent
                  metadata:
                    type: object
                    properties:
                      links:
                        type: object
                        required:
                          - self
                          - first
                          - last
                          - pages
                        properties:
                          self:
                            type: object
                            properties:
                              href:
                                type: string
                                description: URL pointing to the request itself
                          next:
                            type: object
                            properties:
                              href:
                                type: string
                                description: URL pointing to the next page of results in a paginated response.
                                  If there are no more results, this field may
                                  be omitted
                          prev:
                            type: object
                            properties:
                              href:
                                type: string
                                description: URL pointing to the previous page of results in a paginated
                                  response. If there are no more results, this
                                  field may be omitted
                          first:
                            type: object
                            properties:
                              href:
                                type: string
                                description: URL pointing to the first page of results in a paginated response
                          last:
                            type: object
                            properties:
                              href:
                                type: string
                                description: URL pointing to the first page of results in a paginated response
                          pages:
                            type: object
                            description: It may contain a list of other useful URLs, e.g. one entry for
                              page:'page 1', 'page 2'
                            additionalProperties:
                              type: object
                              properties:
                                href:
                                  type: string
                        description: Object containing the links to the related endpoints
                      totalCount:
                        type: number
                        description: Number representing the total number of available items
        "401":
          description: Default Response
          content:
            application/json:
              schema:
                type: object
                required:
                  - code
                  - detail
                  - requestId
                  - name
                  - statusCode
                properties:
                  code:
                    type: string
                    description: Code used to categorize the error
                  detail:
                    type: string
                    description: Description of the error
                  requestId:
                    type: string
                    description: Unique request id. This one will be used to troubleshoot the
                      problems
                  name:
                    type: string
                    description: Name of the error type
                  validation:
                    type: array
                    items:
                      type: object
                      required:
                        - fieldName
                        - message
                      properties:
                        fieldName:
                          type: string
                        message:
                          type: string
                    description: List of the validation errors
                  validationContext:
                    type: string
                  statusCode:
                    type: number
        "403":
          description: Default Response
          content:
            application/json:
              schema:
                type: object
                required:
                  - code
                  - detail
                  - requestId
                  - name
                  - statusCode
                properties:
                  code:
                    type: string
                    description: Code used to categorize the error
                  detail:
                    type: string
                    description: Description of the error
                  requestId:
                    type: string
                    description: Unique request id. This one will be used to troubleshoot the
                      problems
                  name:
                    type: string
                    description: Name of the error type
                  validation:
                    type: array
                    items:
                      type: object
                      required:
                        - fieldName
                        - message
                      properties:
                        fieldName:
                          type: string
                        message:
                          type: string
                    description: List of the validation errors
                  validationContext:
                    type: string
                  statusCode:
                    type: number
        "500":
          description: Default Response
          content:
            application/json:
              schema:
                type: object
                required:
                  - code
                  - detail
                  - requestId
                  - name
                  - statusCode
                properties:
                  code:
                    type: string
                    description: Code used to categorize the error
                  detail:
                    type: string
                    description: Description of the error
                  requestId:
                    type: string
                    description: Unique request id. This one will be used to troubleshoot the
                      problems
                  name:
                    type: string
                    description: Name of the error type
                  validation:
                    type: array
                    items:
                      type: object
                      required:
                        - fieldName
                        - message
                      properties:
                        fieldName:
                          type: string
                        message:
                          type: string
                    description: List of the validation errors
                  validationContext:
                    type: string
                  statusCode:
                    type: number
  /api/v1/messages/:
    post:
      tags:
        - messages
      description: Send a message with optional attachments (multipart/form-data)
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - subject
                - plainTextBody
                - securityLevel
                - language
                - scheduledAt
                - recipient
              properties:
                subject:
                  type: string
                  minLength: 1
                  maxLength: 500
                plainTextBody:
                  type: string
                  minLength: 1
                htmlBody:
                  type: string
                securityLevel:
                  anyOf:
                    - type: string
                      enum:
                        - confidential
                    - type: string
                      enum:
                        - public
                language:
                  anyOf:
                    - type: string
                      enum:
                        - en
                    - type: string
                      enum:
                        - ga
                scheduledAt:
                  type: string
                  format: date-time
                  description: ISO 8601 timestamp (Europe/Dublin TZ assumed)
                recipient:
                  anyOf:
                    - type: object
                      required:
                        - type
                        - firstName
                        - lastName
                        - email
                      properties:
                        type:
                          type: string
                          enum:
                            - email
                        firstName:
                          type: string
                          minLength: 1
                        lastName:
                          type: string
                          minLength: 1
                        email:
                          type: string
                          format: email
                        ppsn:
                          type: string
                        dateOfBirth:
                          type: string
                          format: date
                    - type: object
                      required:
                        - type
                        - ppsn
                        - dateOfBirth
                      properties:
                        type:
                          type: string
                          enum:
                            - identity
                        ppsn:
                          type: string
                          minLength: 5
                        dateOfBirth:
                          type: string
                          format: date
                attachmentsMeta:
                  type: array
                  items:
                    type: object
                    required:
                      - filename
                      - mimeType
                      - sizeBytes
                    properties:
                      filename:
                        type: string
                      mimeType:
                        type: string
                      sizeBytes:
                        type: number
                        minimum: 1
                  maxItems: 10
                attachments: {}
        required: true
      responses:
        "201":
          description: Default Response
          content:
            application/json:
              schema:
                type: object
                required:
                  - data
                properties:
                  data:
                    type: object
                    required:
                      - messageId
                      - recipientId
                      - attachmentIds
                      - status
                    properties:
                      messageId:
                        type: string
                        format: uuid
                      recipientId:
                        type: string
                        format: uuid
                      attachmentIds:
                        type: array
                        items:
                          type: string
                          format: uuid
                      status:
                        type: string
                        enum:
                          - created
                  metadata:
                    type: object
                    properties:
                      links:
                        type: object
                        required:
                          - self
                          - first
                          - last
                          - pages
                        properties:
                          self:
                            type: object
                            properties:
                              href:
                                type: string
                                description: URL pointing to the request itself
                          next:
                            type: object
                            properties:
                              href:
                                type: string
                                description: URL pointing to the next page of results in a paginated response.
                                  If there are no more results, this field may
                                  be omitted
                          prev:
                            type: object
                            properties:
                              href:
                                type: string
                                description: URL pointing to the previous page of results in a paginated
                                  response. If there are no more results, this
                                  field may be omitted
                          first:
                            type: object
                            properties:
                              href:
                                type: string
                                description: URL pointing to the first page of results in a paginated response
                          last:
                            type: object
                            properties:
                              href:
                                type: string
                                description: URL pointing to the first page of results in a paginated response
                          pages:
                            type: object
                            description: It may contain a list of other useful URLs, e.g. one entry for
                              page:'page 1', 'page 2'
                            additionalProperties:
                              type: object
                              properties:
                                href:
                                  type: string
                        description: Object containing the links to the related endpoints
                      totalCount:
                        type: number
                        description: Number representing the total number of available items
        "400":
          description: Default Response
          content:
            application/json:
              schema:
                type: object
                required:
                  - code
                  - detail
                  - requestId
                  - name
                  - statusCode
                properties:
                  code:
                    type: string
                    description: Code used to categorize the error
                  detail:
                    type: string
                    description: Description of the error
                  requestId:
                    type: string
                    description: Unique request id. This one will be used to troubleshoot the
                      problems
                  name:
                    type: string
                    description: Name of the error type
                  validation:
                    type: array
                    items:
                      type: object
                      required:
                        - fieldName
                        - message
                      properties:
                        fieldName:
                          type: string
                        message:
                          type: string
                    description: List of the validation errors
                  validationContext:
                    type: string
                  statusCode:
                    type: number
        "401":
          description: Default Response
          content:
            application/json:
              schema:
                type: object
                required:
                  - code
                  - detail
                  - requestId
                  - name
                  - statusCode
                properties:
                  code:
                    type: string
                    description: Code used to categorize the error
                  detail:
                    type: string
                    description: Description of the error
                  requestId:
                    type: string
                    description: Unique request id. This one will be used to troubleshoot the
                      problems
                  name:
                    type: string
                    description: Name of the error type
                  validation:
                    type: array
                    items:
                      type: object
                      required:
                        - fieldName
                        - message
                      properties:
                        fieldName:
                          type: string
                        message:
                          type: string
                    description: List of the validation errors
                  validationContext:
                    type: string
                  statusCode:
                    type: number
        "403":
          description: Default Response
          content:
            application/json:
              schema:
                type: object
                required:
                  - code
                  - detail
                  - requestId
                  - name
                  - statusCode
                properties:
                  code:
                    type: string
                    description: Code used to categorize the error
                  detail:
                    type: string
                    description: Description of the error
                  requestId:
                    type: string
                    description: Unique request id. This one will be used to troubleshoot the
                      problems
                  name:
                    type: string
                    description: Name of the error type
                  validation:
                    type: array
                    items:
                      type: object
                      required:
                        - fieldName
                        - message
                      properties:
                        fieldName:
                          type: string
                        message:
                          type: string
                    description: List of the validation errors
                  validationContext:
                    type: string
                  statusCode:
                    type: number
        "404":
          description: Default Response
          content:
            application/json:
              schema:
                type: object
                required:
                  - code
                  - detail
                  - requestId
                  - name
                  - statusCode
                properties:
                  code:
                    type: string
                    description: Code used to categorize the error
                  detail:
                    type: string
                    description: Description of the error
                  requestId:
                    type: string
                    description: Unique request id. This one will be used to troubleshoot the
                      problems
                  name:
                    type: string
                    description: Name of the error type
                  validation:
                    type: array
                    items:
                      type: object
                      required:
                        - fieldName
                        - message
                      properties:
                        fieldName:
                          type: string
                        message:
                          type: string
                    description: List of the validation errors
                  validationContext:
                    type: string
                  statusCode:
                    type: number
        "409":
          description: Default Response
          content:
            application/json:
              schema:
                type: object
                required:
                  - code
                  - detail
                  - requestId
                  - name
                  - statusCode
                properties:
                  code:
                    type: string
                    description: Code used to categorize the error
                  detail:
                    type: string
                    description: Description of the error
                  requestId:
                    type: string
                    description: Unique request id. This one will be used to troubleshoot the
                      problems
                  name:
                    type: string
                    description: Name of the error type
                  validation:
                    type: array
                    items:
                      type: object
                      required:
                        - fieldName
                        - message
                      properties:
                        fieldName:
                          type: string
                        message:
                          type: string
                    description: List of the validation errors
                  validationContext:
                    type: string
                  statusCode:
                    type: number
        "413":
          description: Default Response
          content:
            application/json:
              schema:
                type: object
                required:
                  - code
                  - detail
                  - requestId
                  - name
                  - statusCode
                properties:
                  code:
                    type: string
                    description: Code used to categorize the error
                  detail:
                    type: string
                    description: Description of the error
                  requestId:
                    type: string
                    description: Unique request id. This one will be used to troubleshoot the
                      problems
                  name:
                    type: string
                    description: Name of the error type
                  validation:
                    type: array
                    items:
                      type: object
                      required:
                        - fieldName
                        - message
                      properties:
                        fieldName:
                          type: string
                        message:
                          type: string
                    description: List of the validation errors
                  validationContext:
                    type: string
                  statusCode:
                    type: number
        "500":
          description: Default Response
          content:
            application/json:
              schema:
                type: object
                required:
                  - code
                  - detail
                  - requestId
                  - name
                  - statusCode
                properties:
                  code:
                    type: string
                    description: Code used to categorize the error
                  detail:
                    type: string
                    description: Description of the error
                  requestId:
                    type: string
                    description: Unique request id. This one will be used to troubleshoot the
                      problems
                  name:
                    type: string
                    description: Name of the error type
                  validation:
                    type: array
                    items:
                      type: object
                      required:
                        - fieldName
                        - message
                      properties:
                        fieldName:
                          type: string
                        message:
                          type: string
                    description: List of the validation errors
                  validationContext:
                    type: string
                  statusCode:
                    type: number
        "502":
          description: Default Response
          content:
            application/json:
              schema:
                type: object
                required:
                  - code
                  - detail
                  - requestId
                  - name
                  - statusCode
                properties:
                  code:
                    type: string
                    description: Code used to categorize the error
                  detail:
                    type: string
                    description: Description of the error
                  requestId:
                    type: string
                    description: Unique request id. This one will be used to troubleshoot the
                      problems
                  name:
                    type: string
                    description: Name of the error type
                  validation:
                    type: array
                    items:
                      type: object
                      required:
                        - fieldName
                        - message
                      properties:
                        fieldName:
                          type: string
                        message:
                          type: string
                    description: List of the validation errors
                  validationContext:
                    type: string
                  statusCode:
                    type: number
        "503":
          description: Default Response
          content:
            application/json:
              schema:
                type: object
                required:
                  - code
                  - detail
                  - requestId
                  - name
                  - statusCode
                properties:
                  code:
                    type: string
                    description: Code used to categorize the error
                  detail:
                    type: string
                    description: Description of the error
                  requestId:
                    type: string
                    description: Unique request id. This one will be used to troubleshoot the
                      problems
                  name:
                    type: string
                    description: Name of the error type
                  validation:
                    type: array
                    items:
                      type: object
                      required:
                        - fieldName
                        - message
                      properties:
                        fieldName:
                          type: string
                        message:
                          type: string
                    description: List of the validation errors
                  validationContext:
                    type: string
                  statusCode:
                    type: number
        "504":
          description: Default Response
          content:
            application/json:
              schema:
                type: object
                required:
                  - code
                  - detail
                  - requestId
                  - name
                  - statusCode
                properties:
                  code:
                    type: string
                    description: Code used to categorize the error
                  detail:
                    type: string
                    description: Description of the error
                  requestId:
                    type: string
                    description: Unique request id. This one will be used to troubleshoot the
                      problems
                  name:
                    type: string
                    description: Name of the error type
                  validation:
                    type: array
                    items:
                      type: object
                      required:
                        - fieldName
                        - message
                      properties:
                        fieldName:
                          type: string
                        message:
                          type: string
                    description: List of the validation errors
                  validationContext:
                    type: string
                  statusCode:
                    type: number
security:
  - bearerAuth: []
tags:
  - name: messages
    description: Message dispatch and history operations
  - name: healthcheck
    description: Service health status
